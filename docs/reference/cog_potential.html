<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Potential Energy-Based Center of Gravity (COG) — cog_potential • coglyphr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Potential Energy-Based Center of Gravity (COG) — cog_potential"><meta name="description" content="Calculates the center of gravity (COG) of a character-like binary image based on potential energy."><meta property="og:description" content="Calculates the center of gravity (COG) of a character-like binary image based on potential energy."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coglyphr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mutopsy/coglyphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute Potential Energy-Based Center of Gravity (COG)</h1>
      <small class="dont-index">Source: <a href="https://github.com/mutopsy/coglyphr/blob/HEAD/R/cog_potential.r" class="external-link"><code>R/cog_potential.r</code></a></small>
      <div class="d-none name"><code>cog_potential.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the center of gravity (COG) of a character-like binary image based on potential energy.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cog_potential</span><span class="op">(</span><span class="va">img</span>, origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, <span class="st">"topleft"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-img">img<a class="anchor" aria-label="anchor" href="#arg-img"></a></dt>
<dd><p>An image input. Supported inputs are:</p><ul><li><p>A file path to an image file (e.g., PNG, JPEG, TIFF, BMP).</p></li>
<li><p>A <code>cimg</code> object from the <span class="pkg">imager</span> package (if <span class="pkg">imager</span> is installed).</p></li>
<li><p>A numeric matrix <code>[h, w]</code> (grayscale) or numeric array <code>[h, w, ch]</code> (color).</p></li>
</ul><p>The image should be binary in the sense that background pixels take the value 1 (pure white),
and all other pixels are treated as stroke (foreground) pixels.</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>A character string indicating the location of the image origin.
Use <code>"bottomleft"</code> (default) if the y-axis increases upward (Cartesian),
or <code>"topleft"</code> if the y-axis increases downward (as in image arrays).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><dl><dt><code>statistics</code></dt>
<dd><p>A data frame with the following components:</p><ul><li><p><code>center_x</code>, <code>center_y</code>: The (x, y) coordinates of the COG in pixel coordinates of the input image.</p></li>
<li><p><code>center_x_trim</code>, <code>center_y_trim</code>: The COG coordinates relative to the trimmed glyph region, excluding image margins.</p></li>
<li><p><code>center_x_std</code>, <code>center_y_std</code>: The standardized COG coordinates ranging from 0 to 1, based on the trimmed region's width and height.</p></li>
<li><p><code>margin_left</code>, <code>margin_right</code>, <code>margin_top</code>, <code>margin_bottom</code>: Margins between the glyph and the image boundary.</p></li>
<li><p><code>width_original</code>, <code>height_original</code>: Dimensions of the original image.</p></li>
<li><p><code>width_trim</code>, <code>height_trim</code>: Width and height of the trimmed glyph region, excluding margins.</p></li>
</ul></dd>

<dt><code>potentials</code></dt>
<dd><p>A data frame containing the (x, y) coordinates and the normalized potential value
for each pixel within the convex hull. The potentials are normalized so that their sum equals 1.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the potential energy-based method, the center of gravity (COG) is defined as the weighted mean of the coordinates
of all pixels within the convex hull of the stroke region, where the weight at each pixel is determined by the potential
induced by all other stroke pixels.
The method assumes that each stroke pixel contributes a unit mass and exerts an attractive force
on all other pixels within the convex polygon, inversely proportional to their distance,
modeling a simplified gravitational interaction.
To avoid excessive computation, unintended influence from remote regions, and to restrict
the analysis to a perceptually relevant area, the potential is computed only within
the convex polygon (i.e., the same region used in the contour-based COG calculation),
rather than across the entire image.</p>
<p>Let \(S\) be the set of all stroke pixels, and let \(R\) be the set of all pixels within the convex polygon region.
The potential at each pixel \((x, y) \in R\) is defined as:</p>
<p>$$
p(x, y) = \sum_{\substack{(x', y') \in S \\ (x', y') \ne (x, y)}} \frac{1}{\sqrt{(x - x')^2 + (y - y')^2}}
$$</p>
<p>That is, the potential at each point in \(R\) is the sum of the inverse distances to all stroke pixels in \(S\), excluding the case where \((x', y') = (x, y)\).
Pixels outside the convex polygon are assigned a potential value of zero and do not contribute to the COG calculation.</p>
<p>Then, the center of gravity is computed as:</p>
<p>$$
G_x = \left( \sum_{(x, y) \in R} p(x, y) \cdot x \right) / \left( \sum_{(x, y) \in R} p(x, y) \right)
$$
$$
G_y = \left( \sum_{(x, y) \in R} p(x, y) \cdot y \right) / \left( \sum_{(x, y) \in R} p(x, y) \right)
$$</p>
<p>In other words, the COG corresponds to the weighted mean of pixel coordinates in the convex region,
where weights are given by their potential values induced by the distribution of stroke pixels.</p>
<p>This method was originally proposed by Kotani et al. (2006) and has been used
in character analysis and font design to reflect the perceived shape of glyphs more robustly
than simple stroke averaging, and to further improve upon the contour-based COG
by incorporating the spatial distribution of strokes within the convex polygon,
thereby aligning more closely with the subjective impression of a character's center.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kotani, A., Tanemura, Y., Mitsuyama, Y., Asai, Y., Nakamura, Y., &amp; Onoye, T. (2006). Potential energy-based center of gravity evaluation of characters. <em>The Journal of the Institute of Image Electronics Engineers of Japan</em>, <strong>35</strong>(4), 296–305. <a href="https://doi.org/10.11371/iieej.35.296" class="external-link">doi:10.11371/iieej.35.296</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">img_A</span><span class="op">)</span> <span class="co"># load example image from the package</span></span></span>
<span class="r-in"><span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">cog_potential</span><span class="op">(</span><span class="va">img_A</span>, origin <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">result</span><span class="op">$</span><span class="va">statistics</span> <span class="co"># summary data frame</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   center_x center_y center_x_trim center_y_trim center_x_std center_y_std</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 250.4813 209.9258      189.4813      180.9258    0.4999506    0.4102626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   margin_left margin_right margin_top margin_bottom width_original</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          61           61         31            29            500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   height_original width_trim height_trim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             500        378         440</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">potentials</span><span class="op">)</span> <span class="co"># pixel coordinates with normalized potential values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     x  y     value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 223 32 0.5956361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 224 32 0.6030280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 225 32 0.6086636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 226 32 0.6134050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 227 32 0.6175465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 228 32 0.6212331</span>
<span class="r-in"><span>  <span class="va">result</span><span class="op">$</span><span class="va">origin</span>     <span class="co"># image origin specification</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bottomleft"</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hiroyuki Muto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

